<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Configuration - EPD Clock</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <h2>Configuration - EPD Clock</h2>
  <a href="/"><button>Back to dashboard</button></a>

  <section>
    <h3>Wi-Fi (Station)</h3>
    SSID: <input id="wifi_ssid" placeholder="my_wifi"><br>
    Password: <input id="wifi_pass" type="password" placeholder="leave empty to keep current"><br>
    <div style="margin:6px 0;">
      <button id="btnScanWifi" type="button">Scanner les réseaux</button>
      <select id="wifi_scan_list" style="min-width:220px;">
        <option value="">-- sélectionner un réseau scanné --</option>
      </select>
      <span id="wifi_scan_status" style="font-size:12px;color:#555;margin-left:6px;"></span>
    </div>
    <small>Tip: if not configured, the device starts in access-point mode <b>EPD_Clock</b>.</small>
  </section>

  <hr>

  <section>
    <h3>MQTT</h3>
    <label><input type="checkbox" id="mqtt_enabled"> Enable MQTT</label><br>
    Server: <input id="mqtt_host" placeholder="mqtt.local"><br>
    Port: <input id="mqtt_port" type="number" min="1" max="65535"><br>
    User: <input id="mqtt_user"><br>
    Password: <input id="mqtt_pass" type="password" placeholder="leave empty to keep current"><br>
    Topic: <input id="mqtt_topic" placeholder="epdclock/measure"><br>
    <button id="btnMqttTest">Test MQTT</button>
  </section>

  <hr>

  <section>
    <h3>Timing</h3>
    Deep sleep (s): <input id="deepsleep_interval_s" type="number"><br>
    Interactive timeout (ms): <input id="interactive_timeout_ms" type="number"><br>
  </section>

  <hr>
  
  <section>
    <h3>Clock / Timezone</h3>
    Timezone:
    <select id="tz_string">
      <option value="UTC0">UTC (sans heure d'été)</option>
      <option value="CET-1CEST,M3.5.0/2,M10.5.0/3">
        Europe/Paris (UTC+1 / UTC+2, DST auto)
      </option>
    </select><br>
    <small>Used to set system time via NTP, with DST handling.</small>
  </section>
  
  <hr>

  <section>
    <h3>Misc</h3>
    Device name: <input id="device_name"><br>
    Admin user: <input id="admin_user"><br>
    Admin password: <input id="admin_pass" type="password" placeholder="leave empty to keep current"><br>
    <hr>
    <h4>Sensor offsets</h4>
    Temp offset (°C): <input id="temp_offset" type="number" step="0.1" value="0"><br>
    Humidity offset (%): <input id="hum_offset" type="number" step="0.1" value="0"><br>
  </section>

  <hr>

  <button id="btnSave">Save</button>
  <button id="btnReload">Reload</button>
  <button id="btnReboot" style="background-color: #ff6b6b; color: white;">Reboot</button>
  <div id="status"></div>

  <hr>

  <section>
    <h3>Logs</h3>
    <pre id="logOutput" style="white-space:pre-wrap;max-height:400px;overflow:auto;border:1px solid #ccc;padding:8px;margin-top:8px;background:#f5f5f5;font-size:12px;">Loading...</pre>
  </section>

  <script src="/script_config.js"></script>
</body>
</html>
